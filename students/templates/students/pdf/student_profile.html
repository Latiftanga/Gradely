<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Profile - {{ student.get_full_name }}</title>
    <script>
        // Auto-trigger print dialog when page loads
        window.onload = function() {
            window.print();
        }
    </script>
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 10pt;
            line-height: 1.4;
            color: #333;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .school-info h1 {
            font-size: 18pt;
            color: #3b82f6;
            margin-bottom: 3px;
        }

        .school-info p {
            font-size: 9pt;
            color: #666;
        }

        .document-title {
            text-align: right;
        }

        .document-title h2 {
            font-size: 14pt;
            color: #333;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .document-title p {
            font-size: 8pt;
            color: #888;
        }

        /* Profile Section */
        .profile-section {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
        }

        .avatar {
            width: 80px;
            height: 80px;
            background: #3b82f6;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24pt;
            font-weight: bold;
            flex-shrink: 0;
        }

        .profile-info {
            flex: 1;
        }

        .profile-info h2 {
            font-size: 16pt;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .student-id {
            font-family: 'Courier New', monospace;
            font-size: 11pt;
            color: #64748b;
            margin-bottom: 8px;
        }

        .badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 8pt;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-success {
            background: #dcfce7;
            color: #166534;
        }

        .badge-error {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-info {
            background: #dbeafe;
            color: #1e40af;
        }

        .badge-outline {
            background: transparent;
            border: 1px solid #94a3b8;
            color: #64748b;
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .section {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            background: white;
        }

        .section-title {
            font-size: 10pt;
            font-weight: 700;
            color: #3b82f6;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding-bottom: 8px;
            margin-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }

        .field {
            margin-bottom: 8px;
        }

        .field-label {
            font-size: 7pt;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        .field-value {
            font-size: 10pt;
            color: #1e293b;
        }

        .field-value.mono {
            font-family: 'Courier New', monospace;
        }

        .field-value.highlight {
            font-weight: 600;
            color: #3b82f6;
        }

        /* Two Column within section */
        .two-col {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        /* Full width section */
        .full-width {
            grid-column: span 2;
        }

        /* Parents Table */
        .parents-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 9pt;
        }

        .parents-table th {
            background: #f1f5f9;
            padding: 6px 8px;
            text-align: left;
            font-weight: 600;
            color: #475569;
            font-size: 8pt;
            text-transform: uppercase;
        }

        .parents-table td {
            padding: 6px 8px;
            border-bottom: 1px solid #e2e8f0;
        }

        /* Footer */
        .footer {
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
            text-align: center;
            font-size: 8pt;
            color: #94a3b8;
        }

        /* Utility */
        .text-muted {
            color: #94a3b8;
        }

        .text-warning {
            color: #d97706;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="school-info">
            <h1>{% if school %}{{ school.name }}{% else %}Gradely School{% endif %}</h1>
            <p>Student Information System</p>
        </div>
        <div class="document-title">
            <h2>Student Profile</h2>
            <p>Generated: {% now "F d, Y" %}</p>
        </div>
    </div>

    <!-- Profile Section -->
    <div class="profile-section">
        <div class="avatar">{{ student.first_name|slice:":1" }}{{ student.last_name|slice:":1" }}</div>
        <div class="profile-info">
            <h2>{{ student.get_full_name }}</h2>
            <p class="student-id">{{ student.student_id }}</p>
            <div class="badges">
                {% if student.is_active %}
                    <span class="badge badge-success">Active</span>
                {% else %}
                    <span class="badge badge-error">Inactive</span>
                {% endif %}
                {% if student.is_boarder %}
                    <span class="badge badge-info">Boarder</span>
                {% else %}
                    <span class="badge badge-outline">Day Student</span>
                {% endif %}
                {% if student.gender == 'M' %}
                    <span class="badge badge-info">Male</span>
                {% else %}
                    <span class="badge badge-info">Female</span>
                {% endif %}
                {% if student.current_class %}
                    <span class="badge badge-outline">{{ student.current_class }}</span>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Content Grid -->
    <div class="content-grid">
        <!-- Personal Information -->
        <div class="section">
            <div class="section-title">Personal Information</div>
            <div class="two-col">
                <div class="field">
                    <div class="field-label">First Name</div>
                    <div class="field-value">{{ student.first_name }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Middle Name</div>
                    <div class="field-value">{{ student.middle_name|default:"-" }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Last Name</div>
                    <div class="field-value">{{ student.last_name }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Gender</div>
                    <div class="field-value">{% if student.gender == 'M' %}Male{% else %}Female{% endif %}</div>
                </div>
                <div class="field">
                    <div class="field-label">Date of Birth</div>
                    <div class="field-value">{{ student.date_of_birth|date:"F d, Y" }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Age</div>
                    <div class="field-value">{{ student.age }} years</div>
                </div>
            </div>
        </div>

        <!-- Identification -->
        <div class="section">
            <div class="section-title">Identification</div>
            <div class="two-col">
                <div class="field">
                    <div class="field-label">Student ID</div>
                    <div class="field-value mono highlight">{{ student.student_id }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Admission Number</div>
                    <div class="field-value mono">{{ student.admission_number|default:"-" }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Index Number</div>
                    <div class="field-value mono">{{ student.index_number|default:"-" }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Ghana Card Number</div>
                    <div class="field-value mono">{{ student.ghana_card_number|default:"-" }}</div>
                </div>
            </div>
        </div>

        <!-- Academic Information -->
        <div class="section">
            <div class="section-title">Academic Information</div>
            <div class="field">
                <div class="field-label">Current Class</div>
                <div class="field-value highlight">{% if student.current_class %}{{ student.current_class }}{% else %}Not assigned{% endif %}</div>
            </div>
            <div class="two-col">
                <div class="field">
                    <div class="field-label">Admission Date</div>
                    <div class="field-value">{{ student.admission_date|date:"F d, Y"|default:"-" }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Date Enrolled</div>
                    <div class="field-value">{{ student.date_enrolled|date:"F d, Y" }}</div>
                </div>
            </div>
            <div class="field">
                <div class="field-label">Previous School</div>
                <div class="field-value">{{ student.previous_school|default:"Not specified" }}</div>
            </div>
        </div>

        <!-- Location & Origin -->
        <div class="section">
            <div class="section-title">Location & Origin</div>
            <div class="two-col">
                <div class="field">
                    <div class="field-label">Hometown</div>
                    <div class="field-value">{{ student.hometown|default:"-" }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Region</div>
                    <div class="field-value">{{ student.region|default:"-" }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Nationality</div>
                    <div class="field-value">{{ student.nationality }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Residential Status</div>
                    <div class="field-value">{% if student.is_boarder %}Boarder{% else %}Day Student{% endif %}</div>
                </div>
            </div>
            {% if student.house %}
            <div class="field">
                <div class="field-label">House / Dormitory</div>
                <div class="field-value">{{ student.house }}</div>
            </div>
            {% endif %}
            <div class="field">
                <div class="field-label">Residential Address</div>
                <div class="field-value">{{ student.residential_address|default:"Not specified" }}</div>
            </div>
        </div>

        <!-- Health Information -->
        <div class="section">
            <div class="section-title">Health Information</div>
            <div class="two-col">
                <div class="field">
                    <div class="field-label">Blood Group</div>
                    <div class="field-value highlight">{{ student.blood_group|default:"Not specified" }}</div>
                </div>
                <div class="field">
                    <div class="field-label">Allergies</div>
                    <div class="field-value {% if student.allergies %}text-warning{% endif %}">{{ student.allergies|default:"None reported" }}</div>
                </div>
            </div>
            <div class="field">
                <div class="field-label">Medical Conditions</div>
                <div class="field-value {% if student.medical_conditions %}text-warning{% endif %}">{{ student.medical_conditions|default:"None reported" }}</div>
            </div>
        </div>

        <!-- Contact / Account Information -->
        <div class="section">
            <div class="section-title">Contact Information</div>
            <div class="field">
                <div class="field-label">Email Address</div>
                <div class="field-value">
                    {% if '@student.placeholder' in student.user.email %}
                        <span class="text-muted">No email (placeholder account)</span>
                    {% else %}
                        {{ student.user.email }}
                    {% endif %}
                </div>
            </div>
            <div class="field">
                <div class="field-label">Account Status</div>
                <div class="field-value">
                    {% if '@student.placeholder' in student.user.email %}
                        <span class="text-warning">No login access</span>
                    {% else %}
                        Login enabled
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Parents/Guardians - Full Width -->
        <div class="section full-width">
            <div class="section-title">Parents / Guardians</div>
            {% if student.parents.exists %}
            <table class="parents-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Relationship</th>
                        <th>Phone Number</th>
                        <th>Primary</th>
                        <th>Emergency</th>
                    </tr>
                </thead>
                <tbody>
                    {% for parent in student.parents.all %}
                    <tr>
                        <td>{{ parent.get_full_name }}</td>
                        <td>{{ parent.get_relationship_display }}</td>
                        <td>{{ parent.phone_number }}</td>
                        <td>{% if parent.is_primary_contact %}Yes{% else %}-{% endif %}</td>
                        <td>{% if parent.is_emergency_contact %}Yes{% else %}-{% endif %}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="text-muted">No parents/guardians linked to this student.</p>
            {% endif %}
        </div>

        <!-- Enrollment History - Full Width -->
        <div class="section full-width">
            <div class="section-title">Enrollment History</div>
            {% if enrollment_history %}
            <table class="parents-table">
                <thead>
                    <tr>
                        <th>Academic Year</th>
                        <th>Class</th>
                        <th>Programme</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for enrollment in enrollment_history %}
                    <tr>
                        <td>{{ enrollment.academic_year.name }}{% if enrollment.academic_year.is_current %} <span class="badge badge-info" style="font-size: 7pt;">Current</span>{% endif %}</td>
                        <td>{{ enrollment.class_instance }}</td>
                        <td>{{ enrollment.class_instance.programme.name|default:"-" }}</td>
                        <td>{% if enrollment.is_active %}Active{% else %}Archived{% endif %}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="text-muted">No enrollment history available.</p>
            {% endif %}
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>This document was generated from the Student Information System on {% now "F d, Y \a\t H:i" %}.</p>
        <p>{{ student.get_full_name }} | {{ student.student_id }}{% if school %} | {{ school.name }}{% endif %}</p>
    </div>
</body>
</html>
